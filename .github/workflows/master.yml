name: 0 - Full Rustdesk Build and Release

on:
  workflow_dispatch:  # Allows manual triggering

jobs:
  prep:
    uses: ./.github/workflows/prep.yml

  build:
    needs: prep
    uses: ./.github/workflows/build.yml
    secrets: inherit  # Allows all secrets to be passed down
    with:
      rustdesk_config: ${{ secrets.RUSTDESK_CONFIG }}
      rustdesk_password: ${{ secrets.RUSTDESK_PASSWORD }}

  sign:
    needs: build
    uses: ./.github/workflows/sign.yml  # Call the new sign workflow after build

  release:
    needs: sign
    uses: ./.github/workflows/release.yml  # Call the new release workflow after sign
